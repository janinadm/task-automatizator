import{a0 as d,y as o,B as t,a4 as g}from"./BQ0Yrhh0.js";import{u as h}from"./DqtgAKHa.js";const y=d("auth",()=>{const a=o(null),s=o(!1),n=o(!1),r=t(()=>!!a.value),l=t(()=>a.value?.role==="ADMIN"),i=t(()=>a.value?.role==="AGENT"),c=t(()=>a.value?.organization??null),f=t(()=>a.value?.organization?.plan??"FREE");async function v(){s.value=!0;try{const e=await $fetch("/api/users/me");a.value=e.data}catch(e){e?.statusCode!==401&&e?.statusCode!==404&&console.error("[authStore] Failed to fetch current user:",e),a.value=null}finally{s.value=!1,n.value=!0}}function u(){a.value=null,n.value=!1}async function p(){await h().auth.signOut(),u(),await g("/login")}return{currentUser:a,isLoading:s,isInitialized:n,isAuthenticated:r,isAdmin:l,isAgent:i,organization:c,plan:f,fetchCurrentUser:v,clearUser:u,logout:p}});export{y as u};
