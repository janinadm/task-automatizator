import{_ as W}from"./CG-kJPW7.js";import{g as X,A as E,c as l,a as t,t as a,m as i,d as w,k as p,D as F,x as z,p as H,v as Y,q as L,E as Z,T as tt,F as $,r as R,y as h,o as n,n as g,w as et,B as _}from"./BQ0Yrhh0.js";import{u as st}from"./B_U5j8G_.js";import{u as V}from"./doLWckKU.js";const it={class:"animate-fade-in space-y-6"},ot={class:"flex items-center justify-between"},nt={class:"text-white/40 text-sm mt-1"},lt={class:"flex items-center gap-2"},at={class:"w-full max-w-md bg-[#0f0f23]/95 border border-white/10 rounded-2xl p-6 shadow-2xl animate-fade-in"},rt={class:"flex items-center justify-between mb-5"},dt=["disabled"],ut=["disabled"],ct={key:0,class:"animate-fade-in p-4 bg-emerald-500/[0.08] border border-emerald-500/15 rounded-xl"},pt={class:"flex items-center gap-2"},vt=["value"],xt=["disabled"],ht={key:0,class:"animate-spin w-4 h-4",fill:"none",viewBox:"0 0 24 24"},mt={key:0,class:"flex items-center justify-center py-24"},ft={key:1,class:"glass-card p-8 text-center"},wt={key:0},gt={class:"text-sm font-semibold text-white/50 uppercase tracking-wider mb-3 flex items-center gap-2"},kt={class:"space-y-2"},bt={class:"flex items-center gap-3 min-w-0"},yt={class:"min-w-0"},At={class:"text-white/80 text-sm truncate"},Ct={class:"text-white/30 text-xs"},_t=["onClick","disabled"],Mt={key:0,class:"w-4 h-4 text-white/40 animate-spin",fill:"none",viewBox:"0 0 24 24"},It={key:1,class:"w-4 h-4 text-red-400/60 hover:text-red-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},Dt={class:"space-y-3"},$t={class:"flex items-center gap-4 flex-wrap sm:flex-nowrap"},Nt={class:"flex-1 min-w-0"},Bt={class:"flex items-center gap-2 flex-wrap"},Tt={key:0,class:"px-2 py-0.5 rounded-full text-[10px] uppercase tracking-wider bg-red-500/20 text-red-300 border border-red-500/30"},jt={class:"text-white/40 text-sm truncate"},Et={class:"text-white/30 text-xs mt-0.5"},Ft={class:"flex items-center gap-4 text-center"},zt={class:"text-white font-semibold"},Ht={class:"text-emerald-400 font-semibold"},Lt={key:0,class:"flex items-center gap-2 flex-shrink-0"},Rt=["onClick","disabled","title"],Vt={key:0,class:"w-4 h-4 text-white/40 animate-spin",fill:"none",viewBox:"0 0 24 24"},St={key:1,class:"w-4 h-4 text-white/50",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},Pt=["d"],Ut=["onClick","disabled","title"],Gt=["d"],qt={key:0,class:"glass-card p-12 text-center"},Xt=X({__name:"team",async setup(Jt){let u,k;const r=st(),{data:N,pending:S,error:P,refresh:b}=([u,k]=E(()=>V("/api/team",{key:"team-data"},"$eHP_7exu-d")),u=await u,k(),u),y=_(()=>N.value?.data.team??[]),m=_(()=>N.value?.data.currentUserRole==="ADMIN"),A=h(!1),c=h(""),f=h("AGENT"),v=h(!1),x=h(""),{data:U,refresh:M}=([u,k]=E(()=>V("/api/team/invitations",{key:"team-invitations"},"$5a-FIiaTSj")),u=await u,k(),u),G=_(()=>U.value?.data??[]),I=_(()=>G.value.filter(o=>o.status==="PENDING"));async function q(){if(c.value.trim()){v.value=!0,x.value="";try{const o=await $fetch("/api/team/invitations",{method:"POST",body:{email:c.value,role:f.value}});x.value=o.data.inviteUrl,r.success(`Invitation sent to ${c.value}`),c.value="",f.value="AGENT",await M()}catch(o){r.error(o?.data?.message??"Failed to send invitation")}finally{v.value=!1}}}const C=h(null);async function J(o){C.value=o;try{await $fetch(`/api/team/invitations/${o}`,{method:"DELETE"}),r.success("Invitation revoked"),await M()}catch(e){r.error(e?.data?.message??"Failed to revoke invitation")}finally{C.value=null}}function O(o){navigator.clipboard.writeText(o),r.success("Invite link copied!")}const d=h(null);async function K(o){if(!m.value||d.value)return;const e=o.role==="ADMIN"?"AGENT":"ADMIN";d.value=o.id;try{await $fetch(`/api/team/${o.id}`,{method:"PATCH",body:{role:e}}),r.success(`${o.fullName} is now ${e==="ADMIN"?"an Admin":"an Agent"}`),await b()}catch(D){r.error(D?.data?.message??"Failed to update role")}finally{d.value=null}}async function Q(o){if(!(!m.value||d.value)){d.value=o.id;try{await $fetch(`/api/team/${o.id}`,{method:"PATCH",body:{isActive:!o.isActive}}),r.success(`${o.fullName} has been ${o.isActive?"deactivated":"activated"}`),await b()}catch(e){r.error(e?.data?.message??"Failed to update status")}finally{d.value=null}}}function B(o){return new Date(o).toLocaleDateString("en",{month:"short",day:"numeric",year:"numeric"})}function T(o){return new Date(o)<new Date}return(o,e)=>{const D=W;return n(),l("div",it,[t("div",ot,[t("div",null,[e[9]||(e[9]=t("h2",{class:"text-xl font-bold text-white"},"Team",-1)),t("p",nt,a(i(y).length)+" member"+a(i(y).length!==1?"s":"")+" in your organization ",1)]),t("div",lt,[i(m)?(n(),l("button",{key:0,onClick:e[0]||(e[0]=s=>A.value=!0),class:"btn-primary text-sm flex items-center gap-1.5"},[...e[10]||(e[10]=[t("svg",{class:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M18 9v3m0 0v3m0-3h3m-3 0h-3m-2-5a4 4 0 11-8 0 4 4 0 018 0zM3 20a6 6 0 0112 0v1H3v-1z"})],-1),w(" Invite Member ",-1)])])):p("",!0),t("button",{onClick:e[1]||(e[1]=s=>{i(b)(),i(M)()}),class:"btn-ghost text-sm flex items-center gap-1.5"},[...e[11]||(e[11]=[t("svg",{class:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"})],-1),w(" Refresh ",-1)])])])]),(n(),F(tt,{to:"body"},[i(A)?(n(),l("div",{key:0,class:"fixed inset-0 bg-black/60 backdrop-blur-sm z-50 flex items-center justify-center p-4",onClick:e[7]||(e[7]=z(s=>{A.value=!1,x.value=""},["self"]))},[t("div",at,[t("div",rt,[e[13]||(e[13]=t("h3",{class:"text-lg font-bold text-white"},"Invite Team Member",-1)),t("button",{onClick:e[2]||(e[2]=s=>{A.value=!1,x.value=""}),class:"p-1.5 rounded-lg hover:bg-white/[0.06] transition-colors"},[...e[12]||(e[12]=[t("svg",{class:"w-5 h-5 text-white/40",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M6 18L18 6M6 6l12 12"})],-1)])])]),t("form",{onSubmit:z(q,["prevent"]),class:"space-y-4"},[t("div",null,[e[14]||(e[14]=t("label",{class:"block text-sm text-white/60 mb-2 font-medium"},"Email address",-1)),H(t("input",{"onUpdate:modelValue":e[3]||(e[3]=s=>L(c)?c.value=s:null),type:"email",placeholder:"colleague@company.com",class:"input-glass",disabled:i(v)},null,8,dt),[[Y,i(c)]])]),t("div",null,[e[16]||(e[16]=t("label",{class:"block text-sm text-white/60 mb-2 font-medium"},"Role",-1)),H(t("select",{"onUpdate:modelValue":e[4]||(e[4]=s=>L(f)?f.value=s:null),class:"input-glass appearance-none",style:{"background-image":"url('data:image/svg+xml;charset=UTF-8,%3Csvg%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%20width%3D%2212%22%20height%3D%2212%22%20viewBox%3D%220%200%2012%2012%22%3E%3Cpath%20fill%3D%22%239ca3af%22%20d%3D%22M2%204l4%204%204-4%22%2F%3E%3C%2Fsvg%3E')","background-repeat":"no-repeat","background-position":"right 12px center"},disabled:i(v)},[...e[15]||(e[15]=[t("option",{value:"AGENT"},"Agent — Can manage tickets, respond to customers",-1),t("option",{value:"ADMIN"},"Admin — Full access including settings & AI config",-1)])],8,ut),[[Z,i(f)]])]),i(x)?(n(),l("div",ct,[e[18]||(e[18]=t("p",{class:"text-emerald-300 text-sm font-medium mb-2"},"Invite link generated!",-1)),t("div",pt,[t("input",{value:i(x),readonly:"",class:"input-glass text-xs flex-1 text-white/60",onFocus:e[5]||(e[5]=s=>s.target?.select())},null,40,vt),t("button",{type:"button",onClick:e[6]||(e[6]=s=>O(i(x))),class:"p-2.5 rounded-lg bg-white/[0.06] hover:bg-white/[0.1] transition-colors flex-shrink-0",title:"Copy link"},[...e[17]||(e[17]=[t("svg",{class:"w-4 h-4 text-white/60",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M8 5H6a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2v-1M8 5a2 2 0 002 2h2a2 2 0 002-2M8 5a2 2 0 012-2h2a2 2 0 012 2m0 0h2a2 2 0 012 2v3m2 4H10m0 0l3-3m-3 3l3 3"})],-1)])])]),e[19]||(e[19]=t("p",{class:"text-white/30 text-xs mt-2"},"Share this link with your team member. It expires in 7 days.",-1))])):p("",!0),t("button",{type:"submit",disabled:i(v)||!i(c).trim(),class:"w-full py-3 bg-gradient-to-r from-indigo-500 to-purple-600 hover:from-indigo-400 hover:to-purple-500 rounded-xl text-white font-semibold transition-all duration-300 shadow-lg shadow-indigo-500/25 hover:shadow-indigo-500/40 disabled:opacity-40 disabled:cursor-not-allowed flex items-center justify-center gap-2"},[i(v)?(n(),l("svg",ht,[...e[20]||(e[20]=[t("circle",{class:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor","stroke-width":"4"},null,-1),t("path",{class:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4z"},null,-1)])])):p("",!0),w(" "+a(i(v)?"Sending...":"Send Invitation"),1)],8,xt)],32)])])):p("",!0)])),i(S)?(n(),l("div",mt,[...e[21]||(e[21]=[t("div",{class:"animate-spin w-8 h-8 border-2 border-indigo-500 border-t-transparent rounded-full"},null,-1)])])):i(P)?(n(),l("div",ft,[e[22]||(e[22]=t("p",{class:"text-red-300"},"Failed to load team data.",-1)),t("button",{onClick:e[8]||(e[8]=s=>i(b)()),class:"btn-primary mt-4 text-sm"},"Retry")])):(n(),l($,{key:2},[i(m)&&i(I).length>0?(n(),l("div",wt,[t("h3",gt,[e[23]||(e[23]=t("svg",{class:"w-4 h-4 text-amber-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M3 8l7.89 5.26a2 2 0 002.22 0L21 8M5 19h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v10a2 2 0 002 2z"})],-1)),w(" Pending Invitations ("+a(i(I).length)+") ",1)]),t("div",kt,[(n(!0),l($,null,R(i(I),s=>(n(),l("div",{key:s.id,class:"flex items-center justify-between px-4 py-3 bg-amber-500/[0.04] border border-amber-500/10 rounded-xl"},[t("div",bt,[e[24]||(e[24]=t("div",{class:"w-8 h-8 rounded-full bg-amber-500/20 flex items-center justify-center flex-shrink-0"},[t("svg",{class:"w-4 h-4 text-amber-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M3 8l7.89 5.26a2 2 0 002.22 0L21 8M5 19h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v10a2 2 0 002 2z"})])],-1)),t("div",yt,[t("p",At,a(s.email),1),t("p",Ct,[w(a(s.role)+" · Invited by "+a(s.invitedBy.fullName)+" · ",1),t("span",{class:g(T(s.expiresAt)?"text-red-400":"")},a(T(s.expiresAt)?"Expired":`Expires ${B(s.expiresAt)}`),3)])])]),t("button",{onClick:j=>J(s.id),disabled:i(C)===s.id,class:"p-2 rounded-lg hover:bg-white/[0.06] transition-colors flex-shrink-0",title:"Revoke invitation"},[i(C)===s.id?(n(),l("svg",Mt,[...e[25]||(e[25]=[t("circle",{class:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor","stroke-width":"4"},null,-1),t("path",{class:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4z"},null,-1)])])):(n(),l("svg",It,[...e[26]||(e[26]=[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M6 18L18 6M6 6l12 12"},null,-1)])]))],8,_t)]))),128))])])):p("",!0),t("div",null,[e[31]||(e[31]=t("h3",{class:"text-sm font-semibold text-white/50 uppercase tracking-wider mb-3"},"Members",-1)),t("div",Dt,[(n(!0),l($,null,R(i(y),s=>(n(),F(D,{key:s.id,padding:"md",hover:!0},{default:et(()=>[t("div",$t,[t("div",{class:g(["w-12 h-12 rounded-full flex items-center justify-center text-lg font-semibold flex-shrink-0",s.isActive?"bg-indigo-500/20 text-indigo-300":"bg-white/[0.06] text-white/30"])},a(s.fullName?.charAt(0)?.toUpperCase()??"?"),3),t("div",Nt,[t("div",Bt,[t("span",{class:g(["text-white font-semibold truncate",{"opacity-50":!s.isActive}])},a(s.fullName),3),t("span",{class:g(["px-2 py-0.5 rounded-full text-[10px] uppercase tracking-wider font-semibold",s.role==="ADMIN"?"bg-purple-500/20 text-purple-300 border border-purple-500/30":"bg-blue-500/20 text-blue-300 border border-blue-500/30"])},a(s.role),3),s.isActive?p("",!0):(n(),l("span",Tt," Inactive "))]),t("p",jt,a(s.email),1),t("p",Et,"Joined "+a(B(s.createdAt)),1)]),t("div",Ft,[t("div",null,[t("p",zt,a(s.assignedTickets),1),e[27]||(e[27]=t("p",{class:"text-white/30 text-[10px] uppercase tracking-wider"},"Assigned",-1))]),t("div",null,[t("p",Ht,a(s.resolvedTickets),1),e[28]||(e[28]=t("p",{class:"text-white/30 text-[10px] uppercase tracking-wider"},"Resolved",-1))])]),i(m)?(n(),l("div",Lt,[t("button",{onClick:j=>K(s),class:"p-2 rounded-lg bg-white/[0.04] border border-white/[0.06] hover:bg-white/[0.08] transition-colors",disabled:i(d)===s.id,title:s.role==="ADMIN"?"Demote to Agent":"Promote to Admin"},[i(d)===s.id?(n(),l("svg",Vt,[...e[29]||(e[29]=[t("circle",{class:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor","stroke-width":"4"},null,-1),t("path",{class:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4z"},null,-1)])])):(n(),l("svg",St,[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:s.role==="ADMIN"?"M19 9l-7 7-7-7":"M5 15l7-7 7 7"},null,8,Pt)]))],8,Rt),t("button",{onClick:j=>Q(s),class:"p-2 rounded-lg bg-white/[0.04] border border-white/[0.06] hover:bg-white/[0.08] transition-colors",disabled:i(d)===s.id,title:s.isActive?"Deactivate":"Activate"},[(n(),l("svg",{class:g(["w-4 h-4",s.isActive?"text-emerald-400":"text-red-400"]),fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:s.isActive?"M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z":"M18.364 18.364A9 9 0 005.636 5.636m12.728 12.728A9 9 0 015.636 5.636m12.728 12.728L5.636 5.636"},null,8,Gt)],2))],8,Ut)])):p("",!0)])]),_:2},1024))),128)),i(y).length===0?(n(),l("div",qt,[...e[30]||(e[30]=[t("svg",{class:"w-12 h-12 mx-auto text-white/20 mb-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"1.5",d:"M17 20h5v-2a3 3 0 00-5.356-1.857M17 20H7m10 0v-2c0-.656-.126-1.283-.356-1.857M7 20H2v-2a3 3 0 015.356-1.857M7 20v-2c0-.656.126-1.283.356-1.857m0 0a5.002 5.002 0 019.288 0M15 7a3 3 0 11-6 0 3 3 0 016 0z"})],-1),t("p",{class:"text-white/40"},"No team members found",-1)])])):p("",!0)])])],64))])}}});export{Xt as default};
