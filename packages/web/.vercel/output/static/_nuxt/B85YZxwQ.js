import{_ as N}from"./CG-kJPW7.js";import{g as V,A as z,c as l,a as t,d as r,m as i,D as I,x as T,F as u,r as _,p as F,v as K,q,k as f,t as a,T as G,j as J,b as Q,w as L,y as h,o as n,n as b,B as X}from"./BQ0Yrhh0.js";import{u as Y}from"./B_U5j8G_.js";import{u as Z}from"./doLWckKU.js";const ee={class:"animate-fade-in space-y-6"},te={class:"flex items-center justify-between"},se={class:"flex items-center gap-2"},oe={class:"w-full max-w-lg bg-[#0f0f23]/95 border border-white/10 rounded-2xl p-6 shadow-2xl animate-fade-in"},ie={class:"flex items-center justify-between mb-5"},ne={class:"grid grid-cols-2 gap-2"},le=["onClick"],ae={class:"text-lg"},re={class:"text-white text-sm font-medium mt-1"},de={class:"text-white/30 text-xs mt-0.5"},ce=["disabled"],ue={class:"p-4 bg-indigo-500/[0.06] border border-indigo-500/15 rounded-xl"},me={class:"text-white/40 text-xs leading-relaxed"},pe=["disabled"],he={key:0,class:"animate-spin w-4 h-4",fill:"none",viewBox:"0 0 24 24"},ve={key:0,class:"flex items-center justify-center py-24"},we={key:1,class:"glass-card p-8 text-center"},xe={key:0,class:"glass-card p-16 text-center"},fe={key:1,class:"space-y-3"},be={class:"flex items-start gap-4 flex-wrap sm:flex-nowrap"},ge={class:"flex-1 min-w-0"},ke={class:"flex items-center gap-2 flex-wrap"},ye={class:"text-white/40 text-sm mt-0.5"},Ce={key:0,class:"mt-2 flex items-center gap-2"},Ae={class:"text-xs text-white/30 bg-white/[0.04] px-2 py-1 rounded-lg truncate max-w-xs"},_e=["onClick"],Me={class:"flex items-center gap-3 mt-2 text-xs text-white/30"},Se={key:0},$e={class:"flex items-center gap-2 flex-shrink-0"},Be=["onClick","disabled","title"],Ie={key:0,class:"w-4 h-4 text-white/40 animate-spin",fill:"none",viewBox:"0 0 24 24"},Te=["d"],Le=["onClick","disabled"],je={key:0,class:"w-4 h-4 text-white/40 animate-spin",fill:"none",viewBox:"0 0 24 24"},Ee={key:1,class:"w-4 h-4 text-red-400/60",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},Pe={class:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-3"},De={class:"flex items-center gap-2 mb-1"},He={class:"text-lg"},Ue={class:"text-white/70 text-sm font-medium"},We={class:"text-white/30 text-xs"},Fe=V({__name:"integrations",async setup(Oe){let g,M;const m=Y(),{data:j,pending:E,error:P,refresh:x}=([g,M]=z(()=>Z("/api/integrations",{key:"integrations-data"},"$uw9_dKDzf-")),g=await g,M(),g),S=X(()=>j.value?.data??[]),v=h(!1),c=h(""),d=h("WEBHOOK"),w=h(!1),$=h({}),A=[{value:"EMAIL_IMAP",label:"Email (IMAP)",description:"Receive emails as tickets",icon:"ðŸ“§"},{value:"EMAIL_SMTP",label:"Email (SMTP)",description:"Send replies via email",icon:"ðŸ“¤"},{value:"WHATSAPP",label:"WhatsApp",description:"WhatsApp Business API messages",icon:"ðŸ’¬"},{value:"SLACK",label:"Slack",description:"Slack workspace messages",icon:"ðŸ’¼"},{value:"WEBHOOK",label:"Custom Webhook",description:"Generic HTTP webhook integration",icon:"ðŸ”—"}];function B(o){return A.find(e=>e.value===o)??{label:o,description:"",icon:"ðŸ”§"}}async function D(){if(c.value.trim()){w.value=!0;try{const o=await $fetch("/api/integrations",{method:"POST",body:{type:d.value,name:c.value,config:$.value}});m.success(`Integration "${c.value}" created`),v.value=!1,c.value="",d.value="WEBHOOK",$.value={},await x()}catch(o){m.error(o?.data?.message??"Failed to create integration")}finally{w.value=!1}}}const k=h(null);async function H(o){k.value=o.id;try{await $fetch(`/api/integrations/${o.id}`,{method:"PATCH",body:{isActive:!o.isActive}}),m.success(`${o.name} ${o.isActive?"disabled":"enabled"}`),await x()}catch(e){m.error(e?.data?.message??"Failed to update integration")}finally{k.value=null}}const y=h(null);async function U(o){if(confirm(`Delete "${o.name}"? This cannot be undone.`)){y.value=o.id;try{await $fetch(`/api/integrations/${o.id}`,{method:"DELETE"}),m.success(`${o.name} deleted`),await x()}catch(e){m.error(e?.data?.message??"Failed to delete integration")}finally{y.value=null}}}function W(o){const e=`${window.location.origin}${o}`;navigator.clipboard.writeText(e),m.success("Webhook URL copied!")}function O(o){return new Date(o).toLocaleDateString("en",{month:"short",day:"numeric",year:"numeric"})}function R(o){const e=Date.now()-new Date(o).getTime(),p=Math.floor(e/6e4);if(p<1)return"just now";if(p<60)return`${p}m ago`;const s=Math.floor(p/60);return s<24?`${s}h ago`:`${Math.floor(s/24)}d ago`}return(o,e)=>{const p=N;return n(),l("div",ee,[t("div",te,[e[9]||(e[9]=t("div",null,[t("h2",{class:"text-xl font-bold text-white"},"Integrations"),t("p",{class:"text-white/40 text-sm mt-1"}," Connect external channels to receive and respond to tickets ")],-1)),t("div",se,[t("button",{onClick:e[0]||(e[0]=s=>v.value=!0),class:"btn-primary text-sm flex items-center gap-1.5"},[...e[7]||(e[7]=[t("svg",{class:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 4v16m8-8H4"})],-1),r(" Add Integration ",-1)])]),t("button",{onClick:e[1]||(e[1]=s=>i(x)()),class:"btn-ghost text-sm flex items-center gap-1.5"},[...e[8]||(e[8]=[t("svg",{class:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"})],-1),r(" Refresh ",-1)])])])]),(n(),I(G,{to:"body"},[i(v)?(n(),l("div",{key:0,class:"fixed inset-0 bg-black/60 backdrop-blur-sm z-50 flex items-center justify-center p-4",onClick:e[4]||(e[4]=T(s=>v.value=!1,["self"]))},[t("div",oe,[t("div",ie,[e[11]||(e[11]=t("h3",{class:"text-lg font-bold text-white"},"New Integration",-1)),t("button",{onClick:e[2]||(e[2]=s=>v.value=!1),class:"p-1.5 rounded-lg hover:bg-white/[0.06] transition-colors"},[...e[10]||(e[10]=[t("svg",{class:"w-5 h-5 text-white/40",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M6 18L18 6M6 6l12 12"})],-1)])])]),t("form",{onSubmit:T(D,["prevent"]),class:"space-y-5"},[t("div",null,[e[12]||(e[12]=t("label",{class:"block text-sm text-white/60 mb-3 font-medium"},"Channel type",-1)),t("div",ne,[(n(),l(u,null,_(A,s=>t("button",{key:s.value,type:"button",onClick:C=>d.value=s.value,class:b(["p-3 rounded-xl border text-left transition-all duration-200",i(d)===s.value?"border-indigo-500/40 bg-indigo-500/[0.08]":"border-white/[0.06] bg-white/[0.02] hover:bg-white/[0.04]"])},[t("span",ae,a(s.icon),1),t("p",re,a(s.label),1),t("p",de,a(s.description),1)],10,le)),64))])]),t("div",null,[e[13]||(e[13]=t("label",{class:"block text-sm text-white/60 mb-2 font-medium"},"Display name",-1)),F(t("input",{"onUpdate:modelValue":e[3]||(e[3]=s=>q(c)?c.value=s:null),type:"text",placeholder:"e.g. Support Email, Sales WhatsApp",class:"input-glass",disabled:i(w)},null,8,ce),[[K,i(c)]])]),t("div",ue,[e[23]||(e[23]=t("p",{class:"text-indigo-300 text-sm font-medium mb-1"},"How it works",-1)),t("p",me,[i(d)==="WEBHOOK"?(n(),l(u,{key:0},[e[14]||(e[14]=r(" A unique webhook URL will be generated. Send POST requests to this URL with a JSON body containing ",-1)),e[15]||(e[15]=t("code",{class:"text-white/60"},"subject",-1)),e[16]||(e[16]=r(", ",-1)),e[17]||(e[17]=t("code",{class:"text-white/60"},"body",-1)),e[18]||(e[18]=r(", ",-1)),e[19]||(e[19]=t("code",{class:"text-white/60"},"senderName",-1)),e[20]||(e[20]=r(", and ",-1)),e[21]||(e[21]=t("code",{class:"text-white/60"},"senderEmail",-1)),e[22]||(e[22]=r(" to automatically create tickets. ",-1))],64)):i(d)==="EMAIL_IMAP"||i(d)==="EMAIL_SMTP"?(n(),l(u,{key:1},[r(" Configure your email service to forward incoming messages to the generated webhook URL, or set up IMAP polling credentials in the config section after creation. ")],64)):i(d)==="WHATSAPP"?(n(),l(u,{key:2},[r(" Configure the WhatsApp Business API webhook to point to the generated URL. Incoming messages will automatically create tickets. ")],64)):i(d)==="SLACK"?(n(),l(u,{key:3},[r(" Set up a Slack app with Events API and point the webhook URL to the generated endpoint. Channel messages will be converted to tickets. ")],64)):f("",!0)])]),t("button",{type:"submit",disabled:i(w)||!i(c).trim(),class:"w-full py-3 bg-gradient-to-r from-indigo-500 to-purple-600 hover:from-indigo-400 hover:to-purple-500 rounded-xl text-white font-semibold transition-all duration-300 shadow-lg shadow-indigo-500/25 hover:shadow-indigo-500/40 disabled:opacity-40 disabled:cursor-not-allowed flex items-center justify-center gap-2"},[i(w)?(n(),l("svg",he,[...e[24]||(e[24]=[t("circle",{class:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor","stroke-width":"4"},null,-1),t("path",{class:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4z"},null,-1)])])):f("",!0),r(" "+a(i(w)?"Creating...":"Create Integration"),1)],8,pe)],32)])])):f("",!0)])),i(E)?(n(),l("div",ve,[...e[25]||(e[25]=[t("div",{class:"animate-spin w-8 h-8 border-2 border-indigo-500 border-t-transparent rounded-full"},null,-1)])])):i(P)?(n(),l("div",we,[e[26]||(e[26]=t("p",{class:"text-red-300"},"Failed to load integrations.",-1)),t("button",{onClick:e[5]||(e[5]=s=>i(x)()),class:"btn-primary mt-4 text-sm"},"Retry")])):(n(),l(u,{key:2},[i(S).length===0?(n(),l("div",xe,[e[28]||(e[28]=J('<div class="w-16 h-16 mx-auto mb-6 rounded-2xl bg-indigo-500/10 flex items-center justify-center"><svg class="w-8 h-8 text-indigo-400" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="1.5" d="M13.828 10.172a4 4 0 00-5.656 0l-4 4a4 4 0 105.656 5.656l1.102-1.101m-.758-4.899a4 4 0 005.656 0l4-4a4 4 0 00-5.656-5.656l-1.1 1.1"></path></svg></div><h3 class="text-white font-semibold text-lg mb-2">No integrations yet</h3><p class="text-white/40 text-sm mb-6 max-w-md mx-auto"> Connect external channels like Email, WhatsApp, or Slack to automatically receive customer messages as tickets. </p>',3)),t("button",{onClick:e[6]||(e[6]=s=>v.value=!0),class:"btn-primary text-sm inline-flex items-center gap-1.5"},[...e[27]||(e[27]=[t("svg",{class:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 4v16m8-8H4"})],-1),r(" Add your first integration ",-1)])])])):(n(),l("div",fe,[(n(!0),l(u,null,_(i(S),s=>(n(),I(p,{key:s.id,padding:"md",hover:!0},{default:L(()=>[t("div",be,[t("div",{class:b(["w-12 h-12 rounded-xl flex items-center justify-center text-2xl flex-shrink-0",s.isActive?"bg-indigo-500/15":"bg-white/[0.04]"])},a(B(s.type).icon),3),t("div",ge,[t("div",ke,[t("span",{class:b(["text-white font-semibold",{"opacity-50":!s.isActive}])},a(s.name),3),t("span",{class:b(["px-2 py-0.5 rounded-full text-[10px] uppercase tracking-wider font-semibold border",s.isActive?"bg-emerald-500/20 text-emerald-300 border-emerald-500/30":"bg-white/[0.06] text-white/40 border-white/10"])},a(s.isActive?"Active":"Disabled"),3)]),t("p",ye,a(B(s.type).label),1),s.webhookUrl?(n(),l("div",Ce,[t("code",Ae,a(s.webhookUrl),1),t("button",{onClick:C=>W(s.webhookUrl),class:"p-1 rounded hover:bg-white/[0.06] transition-colors flex-shrink-0",title:"Copy full URL"},[...e[29]||(e[29]=[t("svg",{class:"w-3.5 h-3.5 text-white/40",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M8 5H6a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2v-1M8 5a2 2 0 002 2h2a2 2 0 002-2M8 5a2 2 0 012-2h2a2 2 0 012 2m0 0h2a2 2 0 012 2v3m2 4H10m0 0l3-3m-3 3l3 3"})],-1)])],8,_e)])):f("",!0),t("div",Me,[t("span",null,"Created "+a(O(s.createdAt)),1),s.lastSyncAt?(n(),l("span",Se," Â· Last activity "+a(R(s.lastSyncAt)),1)):f("",!0)])]),t("div",$e,[t("button",{onClick:C=>H(s),class:"p-2 rounded-lg bg-white/[0.04] border border-white/[0.06] hover:bg-white/[0.08] transition-colors",disabled:i(k)===s.id,title:s.isActive?"Disable":"Enable"},[i(k)===s.id?(n(),l("svg",Ie,[...e[30]||(e[30]=[t("circle",{class:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor","stroke-width":"4"},null,-1),t("path",{class:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4z"},null,-1)])])):(n(),l("svg",{key:1,class:b(["w-4 h-4",s.isActive?"text-emerald-400":"text-white/30"]),fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:s.isActive?"M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z":"M18.364 18.364A9 9 0 005.636 5.636m12.728 12.728A9 9 0 015.636 5.636m12.728 12.728L5.636 5.636"},null,8,Te)],2))],8,Be),t("button",{onClick:C=>U(s),class:"p-2 rounded-lg bg-white/[0.04] border border-white/[0.06] hover:bg-red-500/10 hover:border-red-500/20 transition-colors",disabled:i(y)===s.id,title:"Delete integration"},[i(y)===s.id?(n(),l("svg",je,[...e[31]||(e[31]=[t("circle",{class:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor","stroke-width":"4"},null,-1),t("path",{class:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4z"},null,-1)])])):(n(),l("svg",Ee,[...e[32]||(e[32]=[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"},null,-1)])]))],8,Le)])])]),_:2},1024))),128))])),Q(p,{padding:"md"},{default:L(()=>[e[33]||(e[33]=t("h3",{class:"text-white font-semibold text-sm mb-3 flex items-center gap-2"},[t("svg",{class:"w-4 h-4 text-indigo-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})]),r(" Supported Channels ")],-1)),t("div",Pe,[(n(),l(u,null,_(A,s=>t("div",{key:s.value,class:"p-3 rounded-xl bg-white/[0.02] border border-white/[0.04]"},[t("div",De,[t("span",He,a(s.icon),1),t("span",Ue,a(s.label),1)]),t("p",We,a(s.description),1)])),64))])]),_:1})],64))])}}});export{Fe as default};
